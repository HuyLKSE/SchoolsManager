<header class="sticky top-0 z-30 border-b border-white/60 bg-pageBg/90 backdrop-blur-xl">
  <div class="px-3 py-2 sm:px-4 md:px-5 lg:px-6">
    <div class="flex items-center justify-between gap-4">
      <div class="flex items-center gap-3">
        <div>
          <p class="text-xs text-text-muted hidden sm:block">XIN CHA?O</p>
          <h1 class="text-base sm:text-lg font-bold text-text-dark flex items-center gap-1.5">
            <span id="userName">Admin</span>
            <span class="text-sm">dY`<</span>
            <span class="inline-flex items-center gap-1 rounded-full border px-2 py-0.5 text-[11px] font-semibold <%= isEnglishMode ? 'border-green-200 bg-green-50 text-green-700' : 'border-primary-200 bg-primary-50 text-primary-700' %>">
              <%= isEnglishMode ? 'Chế độ học tập' : 'Chế độ quản lý' %>
            </span>
          </h1>
        </div>
        <p class="hidden md:block text-xs text-text-muted">Cập nhật hoạt động học tập hôm nay.</p>
      </div>
      <div class="flex items-center gap-2">
        <div class="hidden sm:flex items-center gap-1 mr-1">
          <div class="relative">
            <input type="search" placeholder="Tìm kiếm..." class="w-32 lg:w-40 px-2 py-1 pl-7 text-xs border border-border-subtle rounded-full bg-white focus:border-primary-300 focus:ring-1 focus:ring-primary-100 transition outline-none">
            <svg class="h-3 w-3 absolute left-2 top-1.5 text-text-muted" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
            </svg>
          </div>
          <button class="hidden lg:inline-flex items-center gap-1 px-2 py-1 text-xs font-medium text-primary-600 bg-white border border-border-subtle rounded-full hover:bg-primary-50 transition" type="button">
            <span class="h-1.5 w-1.5 rounded-full bg-gradient-to-r from-primary-500 to-secondary-500"></span>
            <span>AI</span>
          </button>
          <button class="hidden xl:inline-flex items-center px-2 py-1 text-xs font-medium text-text-muted bg-white border border-border-subtle rounded-full hover:bg-surface-soft transition" type="button">Tuần</button>
          <button class="hidden xl:inline-flex items-center px-2 py-1 text-xs font-medium text-text-muted bg-white border border-border-subtle rounded-full hover:bg-surface-soft transition" type="button">Tháng</button>
        </div>
        <button class="inline-flex h-7 w-7 sm:h-8 sm:w-8 items-center justify-center rounded-lg border border-white/60 bg-white/80 text-text-dark hover:text-primary-500 transition sm:hidden">
          <svg class="h-4 w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z" />
          </svg>
        </button>
        <button class="inline-flex h-7 w-7 sm:h-8 sm:w-8 items-center justify-center rounded-lg border border-white/60 bg-white/80 text-text-dark hover:text-primary-500 transition relative">
          <svg class="h-3.5 w-3.5 sm:h-4 sm:w-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.6" d="M15 17h5l-1.4-1.4A2 2 0 0118 14V11a6 6 0 00-4-5.6V5a2 2 0 10-4 0v.4A6 6 0 006 11v3c0 .5-.2 1-.6 1.4L4 17h5m6 0v1a3 3 0 11-6 0v-1" />
          </svg>
          <span class="absolute -top-0.5 -right-0.5 h-1.5 w-1.5 rounded-full bg-danger"></span>
        </button>
        <% if (!isEnglishMode && (user && (user.englishProfile?.enabled || user.role === 'admin' || user.role === 'teacher'))) { %>
          <a href="/english/dashboard" class="hidden sm:inline-flex items-center gap-1 rounded-lg border border-green-200 bg-green-50 px-2.5 py-1 text-xs font-semibold text-green-700 hover:bg-green-100">Chuyển chế độ học</a>
        <% } else if (isEnglishMode) { %>
          <a href="/dashboard" class="hidden sm:inline-flex items-center gap-1 rounded-lg border border-primary-200 bg-primary-50 px-2.5 py-1 text-xs font-semibold text-primary-700 hover:bg-primary-100">← Quay lại</a>
        <% } %>
        <div class="flex items-center gap-1.5 sm:gap-2 rounded-full border border-white/60 bg-white/80 px-1.5 sm:px-2 py-0.5 sm:py-1">
          <span class="inline-flex h-6 w-6 sm:h-7 sm:w-7 items-center justify-center rounded-lg bg-gradient-to-br from-primary-500 to-secondary-500 text-white text-xs font-semibold">AD</span>
          <div class="text-left hidden sm:block">
            <p class="text-xs font-semibold text-text-dark leading-tight" id="userNameFull">Admin User</p>
            <p class="text-xs text-text-muted leading-tight">Quản trị viên</p>
          </div>
        </div>
      </div>
    </div>
  </div>
</header>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    loadUserInfo();
  });

  async function loadUserInfo() {
    try {
      const response = await fetch('/api/v1/auth/me', { credentials: 'include' });
      if (!response.ok) return;
      const data = await response.json();
      const user = data.user;
      if (!user) return;

      const userName = document.getElementById('userName');
      const userNameFull = document.getElementById('userNameFull');
      if (userName) userName.textContent = user.fullName || user.username;
      if (userNameFull) userNameFull.textContent = user.fullName || user.username;
    } catch (error) {
      console.warn('Không thể tải thông tin người dùng');
    }
  }
</script>
